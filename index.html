<!DOCTYPE html>
<html>
<head>
	<title>asd</title>
	<style>
		iq-container {
			display: block;
			border: 1px dotted;
			margin: 5px;
			padding: 5px;
		}
	</style>
	<script src="vdom.js"></script>
</head>
<body>
	<div data-iq-component="Component">{{this.keyword}} {{location}} is cool: {{this.appState.get('cool')}}</div>
	<div data-iq-component="Component">hello {{this.keyword}}!<ul>{{this.items.map(item => '<li>' + item + '</li>').join('')}}</ul></div>
	<div data-iq-component="TimerComponent">{{this.time.minutes}} <span>minutes ({{time.seconds}} seconds) have passed since you opened this page</span></div>

	<div data-iq-component="ParentComponent">
		hello {{people}}, {{this.appState.get('cool')}}!
		<div data-iq-component="TimerComponent">
			{{this.time.seconds}} second{{this.time.seconds === 1 ? '' : 's'}} {{this.time.seconds === 1 ? 'has' : 'have'}} passed.

			<button data-iq:click="this.reset()" data-asd="haha">reset!</button>
		</div>
		how are you doing?
		{{this.list.get('haha').a}}
	</div>

	<div data-iq-component="TwoWayBindingComponent">
		<input type="text" data-iq:input="this.updateState($iqEvent)">
		<span>the text is {{this.text}}</span>
		<div>and the <a href="{{this.text}}" class="{{this.text === 'hello' ? 'good' : 'bad'}}" data-iq:click="this.alert($iqEvent);">{{this.text}}</a> link.</div>
	</div>

	<div data-iq-component="ToDoApp">
		<ul>
			{{this.items.map(item => `<li>${item}</li>`).join('')}}
		</ul>
		<input type="text" placeholder="todo item">
		<button data-iq:click="this.addItem()">add</button>
	</div>


	<!-- Maybe someday... -->
	<!-- <div data-iq-component="Component"><ul><li data-iq-for="let item of items">{{item}}</li></ul></div> -->
</body>
<script>
	'use strict';
	/* exported Component, TimerComponent, ParentComponent, TwoWayBindingComponent */
	function Component({ view, appState }) {
		setTimeout(() => {
			this.keyword = 'lll';
		}, 1000);

		setTimeout(() => {
			this.keyword = 'michael again!';

			// Either these two...
			this.items.push('d');
			// view.ComponentShouldChange();

			// Or this.
			// this.items = this.items.concat('d');

			appState.update('cool', false);
		}, 1500);

		this.keyword = 'michael';
		this.items = ['a', 'b', 'c'];

		this.appState = appState;
		appState.update('cool', true);
	}

	function TimerComponent() {
		this.time = {
			seconds: 0,
			minutes: 0
		};

		setInterval(() => {
			this.time.minutes++;
		}, 60*1000);

		setInterval(() => {
			this.time.seconds++;
		}, 1000);

		this.reset = () => {
			this.time.seconds = 0;
			this.time.minutes = 0;
		};
	}

	function ParentComponent({ view, appState }) {
		this.people = 'yall';
		this.list = new Map();
		this.list.set('haha', {
			a: 'hello'
		});

		setTimeout(() => {
			this.list.get('haha').a = 'bye';
			view.ComponentShouldChange();
		}, 1000);

		this.appState = appState;
	}

	function TwoWayBindingComponent({host}) {
		this.updateState = (e) => {
			this.text = e.target.value;
		};

		this.text = 'hello';

		host.querySelector('input').value = this.text;

		this.alert = (e) => {
			alert(this.text);
			e.preventDefault();
		};
	}

	function ToDoApp({host}) {
		// TODO: If this starts as empty, it fails.
		this.items = ['Buy stuff'];

		this.addItem = () => {
			const todo = host.querySelector('input');
			this.items.push(todo.value)

			todo.value = '';
			todo.focus();
		};
	}
</script>
</html>